---
import { Icon } from '@astrojs/starlight/components'
import type { Props } from '@astrojs/starlight/props'

import { getBlogEntry, type StarlightBlogEntryPaginated } from '../libs/content'
import { isAnyBlogPostPage } from '../libs/page'
import { getReadingTime, type ReadingTimeResult } from '../libs/readingTime'

const { locale, slug, entry } = Astro.props

const isBlogPost = isAnyBlogPostPage(slug)
let blogEntry: StarlightBlogEntryPaginated | undefined = undefined
let readingTime: ReadingTimeResult | undefined = undefined

if (isBlogPost) {
  blogEntry = await getBlogEntry(slug, locale)
  readingTime = getReadingTime(blogEntry.entry, entry.body.toString())
}
---

<h1 id={'_top'}>{Astro.props.entry.data.title}</h1>

{
  isBlogPost && readingTime.showReadingTime && (
    <p>
      <Icon name="seti:clock" /> {readingTime.readingTime} min
    </p>
  )
}

<style>
  h1 {
    margin-top: 1rem;
    font-size: var(--sl-text-h1);
    line-height: var(--sl-line-height-headings);
    font-weight: 600;
    color: var(--sl-color-white);
  }

  p > svg {
    transform: translateY(2px);
    margin-right: 4px;
  }
</style>
